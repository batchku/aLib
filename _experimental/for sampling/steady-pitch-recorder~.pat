max v2;#N vpatcher 28 42 1195 744;#P window setfont "Sans Serif" 9.;#P flonum 607 286 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P flonum 686 294 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 258 502 35 196617 del 25;#P newex 16 583 27 196617 t;#P newex 258 551 83 196617 t b 1 reset clear;#P newex 82 515 64 196617 t reset s b s;#P newex 54 669 78 196617 print to-record;#P newex 141 667 75 196617 print to-buffer;#P newex 165 592 18 196617 t i;#P newex 281 630 27 196617 gate;#P newex 218 666 109 196617 buffer~ do-not-worry;#P user multiSlider 35 340 88 158 0. 12. 1 3193 15;#M frgb 0 0 0;#M brgb 255 255 255;#M rgb2 127 127 127;#P user number~ 426 388 465 403 9 3 3 2 0. 0. 0 0. 250 0.;#P user number~ 430 546 469 561 9 3 3 2 0. 0. 0 0. 250 0.;#P user number~ 421 579 460 594 9 3 3 2 0. 0. 0 0. 250 0.;#P newex 775 495 61 196617 prepend set;#N comlet (bang) just made a recording;#P outlet 542 662 15 0;#P newex 542 638 30 196617 sel 0;#P newex 964 110 45 196617 loadbang;#P flonum 126 229 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 192 229 35 196617 % 12.;#N coll init_rag 1;#T flags 1 0;#T 1 0 Sa 0;#T 2 2 Re 0;#T 3 4 ga 0;#T 4 5 ma 0;#T 5 7 Pa 0;#T 6 9 dha 0;#T 7 11 ni 0;#P newobj 936 223 73 196617 coll init_rag 1;#P message 932 142 31 196617 dump;#P message 900 243 14 196617 0;#P newex 865 160 27 196617 t i i;#P newex 346 629 27 196617 gate;#P newex 333 341 27 196617 b;#N comlet (list) midipitch \, buffername \, length;#P outlet 480 662 15 0;#P newex 603 509 70 196617 prepend refer;#N coll init_rag 1;#T flags 1 0;#T 1 0 Sa 0;#T 2 2 Re 0;#T 3 4 ga 0;#T 4 5 ma 0;#T 5 7 Pa 0;#T 6 9 dha 0;#T 7 11 ni 0;#P newobj 480 613 73 196617 coll init_rag 1;#P newex 480 584 27 196617 int;#P newex 870 195 30 196617 sel 0;#P message 870 243 28 196617 none;#P toggle 865 138 15 0;#N coll init_steady-note-grabber 1;#T flags 1 0;#T 1 /pitch-tolerance 0.5;#T 2 /fade-in 111;#T 3 /fade-out 111;#T 4 /min-length 700;#T 5 /pitch-latency 1024;#T 6 /pitch-coll init_rag;#P newobj 932 173 152 196617 coll init_steady-note-grabber 1;#N comlet OSC;#P inlet 396 43 15 0;#N comlet Input (signal);#P inlet 212 45 15 0;#N vpatcher 403 119 789 389;#P window setfont "Sans Serif" 9.;#P number 157 58 59 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P number 158 78 59 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 90 51 33 196617 timer;#N comlet Stop note (bang);#P inlet 113 29 15 0;#N comlet Start note (bang);#P inlet 90 29 15 0;#N comlet Which note (coll index);#P inlet 132 29 15 0;#N comlet Coll name;#P inlet 243 29 15 0;#P newex 243 124 70 196617 prepend refer;#N coll init_rag;#T flags 1 0;#T 1 0 Sa 0;#T 2 2 Re 0;#T 3 4 ga 0;#T 4 5 ma 0;#T 5 7 Pa 0;#T 6 9 dha 0;#T 7 11 ni 0;#P newobj 150 154 74 196617 coll;#P newex 90 76 27 196617 t b i;#P message 90 101 23 196617 sub;#P newex 90 124 95 196617 sprintf %s %i 3 %i;#P connect 7 0 9 0;#P connect 9 0 2 0;#P connect 2 0 1 0;#P connect 1 0 0 0;#P connect 8 0 9 1;#P connect 6 0 0 1;#P connect 0 0 3 0;#P connect 4 0 3 0;#P connect 6 0 11 0;#P connect 2 1 0 2;#P connect 5 0 4 0;#P pop;#P newobj 314 386 65 196617 p note-length;#P newex 258 481 29 196617 t b s;#P newex 473 385 27 196617 t b i;#P newex 466 411 27 196617 -;#P newex 444 435 32 196617 delay;#P newex 215 437 53 196617 unpack f s;#P newex 228 390 70 196617 prepend refer;#P message 389 578 14 196617 0;#P newex 258 457 60 196617 prepend set;#P newex 334 665 110 196617 record~ do-not-worry;#P newex 192 341 79 196617 t b b i b i i;#N coll init_rag;#T flags 1 0;#T 1 0 Sa 0;#T 2 2 Re 0;#T 3 4 ga 0;#T 4 5 ma 0;#T 5 7 Pa 0;#T 6 9 dha 0;#T 7 11 ni 0;#P newobj 215 415 65 196617 coll;#P newex 192 315 140 196617 route startrecord stoprecord;#P newex 694 244 19 196617 t f;#P newex 638 221 19 196617 t f;#P newex 382 543 27 196617 *~;#P newex 444 476 29 196617 float;#P newex 414 476 29 196617 float;#N vpatcher 50 40 310 333;#N comlet Bang when fade-out complete;#P outlet 93 230 15 0;#P window setfont "Sans Serif" 9.;#P newex 123 63 27 196617 t f b;#P newex 93 207 28 196617 t b b;#P message 108 150 14 196617 1;#P message 92 150 14 196617 0;#P newex 93 182 27 196617 gate;#N comlet Signal;#P outlet 35 166 15 0;#P newex 123 89 55 196617 prepend 0.;#N comlet Fade out (# ms);#P inlet 123 43 15 0;#N comlet Fade in (# ms);#P inlet 35 39 15 0;#P newex 35 66 40 196617 t i b b;#P newex 35 89 61 196617 prepend 1.;#P message 52 109 23 196617 0.;#P newex 35 142 30 196617 line~;#P connect 4 0 3 0;#P connect 3 0 2 0;#P connect 2 0 0 0;#P connect 1 0 0 0;#P connect 6 0 0 0;#P connect 0 0 7 0;#P connect 3 1 1 0;#P fasten 11 1 9 0 116 229 149 229 149 133 97 133;#P connect 3 2 9 0;#P connect 10 0 8 0;#P connect 9 0 8 0;#P connect 8 0 11 0;#P connect 11 0 13 0;#P connect 12 1 10 0;#P connect 0 1 8 1;#P connect 5 0 12 0;#P connect 12 0 6 0;#P pop;#P newobj 414 499 40 196617 p fades;#P newex 396 71 602 196617 OSC-route /min-length /pitch-coll /pitch-tolerance /fade-in /fade-out /pitch /pitch-latency /record /init /buffer-name;#N vpatcher 50 40 206 190;#P outlet 22 106 15 0;#P window setfont "Sans Serif" 9.;#P newex 89 49 27 196617 t b i;#P newex 55 49 27 196617 t b i;#P newex 22 82 101 196617 expr $i1 + $i2 + $i3;#P inlet 89 29 15 0;#P inlet 55 29 15 0;#P inlet 22 29 15 0;#P connect 0 0 3 0;#P connect 5 0 3 0;#P connect 4 0 3 0;#P connect 3 0 6 0;#P connect 1 0 4 0;#P connect 4 1 3 1;#P connect 2 0 5 0;#P connect 5 1 3 2;#P pop;#P newobj 378 243 55 196617 p trig-plus;#P newex 346 205 64 196617 sampstoms~;#N vpatcher 401 51 983 486;#P window setfont "Sans Serif" 9.;#P newex 263 340 99 196617 prepend startrecord;#P newex 263 319 27 196617 int;#P number 82 68 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 41 68 40 196617 nothing;#P newex 453 297 40 196617 nothing;#P message 453 269 14 196617 1;#P newex 438 237 40 196617 t i b b;#P message 365 170 14 196617 1;#P newex 365 146 28 196617 t b b;#P newex 365 126 58 196617 select none;#P newex 413 215 35 196617 select;#P newex 287 185 40 196617 t i i i;#P newex 270 235 40 196617 t b b i;#P message 210 198 14 196617 3;#P newex 210 178 28 196617 t b b;#P message 307 319 55 196617 stoprecord;#P outlet 263 367 15 0;#P message 163 361 28 196617 time;#P newex 245 211 35 196617 select;#P message 175 178 14 196617 1;#P newex 175 149 28 196617 t b b;#P newex 175 128 81 196617 select none time;#P message 41 43 14 196617 1;#P newex 41 22 45 196617 loadbang;#P message 92 172 14 196617 2;#N comlet Min note length (ms);#P inlet 180 282 15 0;#P newex 163 310 27 196617 int;#P newex 92 150 40 196617 t b b i;#P message 41 149 14 196617 1;#P newex 41 126 61 196617 select none;#P newex 79 231 40 196617 nothing;#N vpatcher 50 40 194 198;#P window setfont "Sans Serif" 9.;#P message 65 65 27 196617 stop;#P newex 18 65 27 196617 t b i;#P newex 18 91 32 196617 delay;#N comlet Bangs when timer done;#P outlet 18 115 15 0;#N comlet reset;#P inlet 65 37 15 0;#N comlet #ms to wait;#P inlet 18 37 15 0;#P connect 0 0 4 0;#P connect 4 0 3 0;#P connect 5 0 3 0;#P connect 3 0 2 0;#P connect 4 1 3 1;#P connect 1 0 5 0;#P pop;#P newobj 163 340 41 196617 p timer;#P newex 41 99 364 196617 gate 3;#N comlet Pitch or nutting;#P inlet 111 35 15 0;#P comment 121 308 45 196617 Min note length;#P message 132 352 26 196617 500;#P comment 275 162 65 196617 Current note;#P connect 13 0 14 0;#P connect 14 0 33 0;#P fasten 6 0 33 0 84 259 5 259 5 64 46 64;#P fasten 32 0 33 0 458 323 526 323 526 64 46 64;#P connect 33 0 4 0;#P connect 4 0 7 0;#P connect 7 0 8 0;#P connect 8 0 6 0;#P connect 12 0 6 0;#P connect 17 0 6 0;#P connect 23 0 6 0;#P connect 33 0 34 0;#P connect 7 1 9 0;#P connect 9 0 12 0;#P connect 9 1 10 0;#P connect 24 0 10 0;#P connect 1 0 5 0;#P connect 10 0 5 0;#P connect 5 0 19 0;#P connect 4 1 15 0;#P connect 15 0 16 0;#P connect 16 0 17 0;#P connect 11 0 10 1;#P connect 16 1 5 1;#P connect 24 1 5 1;#P connect 15 1 22 0;#P connect 22 0 23 0;#P connect 15 2 18 0;#P connect 22 1 35 0;#P connect 35 0 36 0;#P connect 36 0 20 0;#P connect 21 0 20 0;#P connect 25 0 18 1;#P connect 18 1 24 0;#P connect 25 1 35 1;#P fasten 9 2 25 0 127 174 292 174;#P fasten 24 2 25 0 305 256 329 256 329 174 292 174;#P connect 28 1 21 0;#P connect 30 2 21 0;#P connect 4 2 27 0;#P connect 27 0 28 0;#P connect 28 0 29 0;#P fasten 19 0 4 1 168 412 537 412 537 86 400 86;#P connect 3 0 4 1;#P fasten 30 0 4 1 443 260 486 260 486 94 400 94;#P connect 27 1 26 0;#P fasten 25 2 26 1 322 207 443 207;#P connect 26 1 30 0;#P connect 30 1 31 0;#P connect 31 0 32 0;#P connect 29 0 32 0;#P pop;#P newobj 192 286 90 196617 p FSM;#P newex 192 264 84 196617 coll-close-match;#P newex 393 342 63 196617 tapout~ 100;#P newex 393 315 63 196617 tapin~ 1000;#P comment 663 357 110 196617 Latency: Fiddle window size + min note length + fade-in time;#P comment 268 197 73 196617 <- fiddle window size ->;#P comment 499 415 147 196617 Echoic memory includes min note length \, so compensate by delaying stop-record message.;#P comment 508 585 138 196617 index of pitch being recorded;#P fasten 46 0 55 0 197 313 40 313;#P connect 41 0 60 0;#P connect 46 0 47 0;#P connect 57 0 59 0;#P connect 42 0 58 0;#P connect 10 5 46 0;#P connect 46 0 6 0;#P connect 34 0 7 0;#P connect 6 0 7 0;#P connect 7 0 17 0;#P connect 17 0 19 0;#P connect 23 0 18 0;#P connect 19 2 18 0;#P connect 18 0 24 0;#P connect 57 0 56 0;#P connect 10 1 23 0;#P connect 10 1 6 1;#P connect 24 1 21 0;#P connect 21 0 28 0;#P connect 28 0 64 0;#P connect 64 0 62 0;#P connect 10 2 6 2;#P connect 10 0 7 1;#P connect 58 0 57 0;#P fasten 28 1 57 1 349 549;#P connect 62 3 57 1;#P connect 19 3 29 0;#P connect 11 1 29 1;#P connect 17 1 40 0;#P connect 41 0 20 0;#P connect 14 0 20 0;#P connect 43 0 20 0;#P connect 51 0 20 0;#P connect 10 6 8 0;#P connect 58 0 41 0;#P connect 19 4 29 2;#P connect 62 1 41 1;#P connect 62 2 41 1;#P connect 22 0 41 1;#P fasten 28 1 41 1 350 550;#P connect 10 1 29 3;#P connect 10 3 9 0;#P connect 5 0 14 0;#P connect 11 1 22 0;#P connect 30 0 4 0;#P connect 9 0 5 0;#P connect 4 0 5 0;#P connect 31 0 10 0;#P fasten 32 0 10 0 937 212 1047 212 1047 66;#P connect 11 0 14 1;#P connect 8 1 9 1;#P connect 62 0 12 0;#P connect 12 0 11 0;#P connect 14 0 52 0;#P connect 10 0 9 2;#P connect 5 0 54 0;#P connect 11 0 53 0;#P connect 15 0 12 1;#P connect 40 1 25 0;#P connect 25 0 13 0;#P connect 13 0 11 1;#P connect 16 0 13 1;#P connect 10 0 26 0;#P connect 27 0 26 0;#P connect 26 0 25 1;#P connect 10 4 27 0;#P connect 40 0 36 0;#P connect 36 0 37 0;#P connect 38 0 37 0;#P connect 37 0 39 0;#P connect 27 1 26 1;#P connect 19 5 36 1;#P connect 41 0 49 0;#P connect 49 0 50 0;#P connect 10 1 38 0;#P connect 15 0 66 0;#P connect 10 3 15 0;#P connect 16 0 65 0;#P connect 10 4 16 0;#P connect 10 9 51 0;#P connect 10 7 33 0;#P connect 33 0 42 0;#P connect 42 1 35 0;#P connect 35 0 34 0;#P connect 35 0 43 0;#P connect 48 0 44 0;#P connect 10 8 44 0;#P connect 44 0 32 0;#P pop;